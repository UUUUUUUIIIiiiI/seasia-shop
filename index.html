<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seasia Shop - é¦–é¡µ</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    body {
      font-family: 'Inter', 'Noto Sans SC', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
    }

    /* é¡¶éƒ¨å¯¼èˆªæ  */
    .navbar {
      background-color: #fff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }

    .cart-icon {
      position: relative;
      cursor: pointer;
    }

    .cart-count {
      position: absolute;
      top: -5px;
      right: -8px;
      background-color: red;
      color: white;
      font-size: 12px;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* é¡¶éƒ¨æ¨ªå¹…åŒº */
    .hero-section {
      position: relative;
      width: 100%;
      height: 320px;
      background: linear-gradient(to right, rgba(0,0,0,0.3), rgba(0,0,0,0.4)),
                  url('https://via.placeholder.com/1200x400?text=Seasia+Shop+Welcome');
      background-size: cover;
      background-position: center;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .hero-section h1 {
      font-size: 2rem;
      font-weight: bold;
    }

    /* å•†å“è½®æ’­å±•ç¤º */
    .product-carousel {
      margin-top: -80px;
      z-index: 5;
      position: relative;
    }

    .carousel-item img {
      border-radius: 15px;
      object-fit: cover;
      height: 250px;
    }

    .carousel-caption {
      background: rgba(0,0,0,0.5);
      border-radius: 10px;
      padding: 10px;
    }

    /* å•†å“å¡ç‰‡å±•ç¤º */
    .product-card {
      border: none;
      border-radius: 15px;
      transition: all 0.3s ease;
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }

    /* ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 768px) {
      .hero-section {
        height: 200px;
      }
      .carousel-item img {
        height: 180px;
      }
    }
  </style>
</head>
<body>

  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <nav class="navbar navbar-expand-lg navbar-light sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">ğŸŒ Seasia Shop</a>
      <div class="ms-auto">
        <div class="cart-icon" onclick="goCart()">
          <img src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png" alt="cart" width="28">
          <div class="cart-count" id="cartCount">0</div>
        </div>
      </div>
    </div>
  </nav>

  <!-- é¡¶éƒ¨æ¨ªå¹… -->
  <div class="hero-section">
    <div>
      <h1>Seasia Shop</h1>
      <p>ä¸ºä¸œå—äºšå¹´è½»äººæä¾›é«˜å“è´¨ç²¾é€‰å•†å“ ğŸŒ</p>
    </div>
  </div>

  <!-- å•†å“è½®æ’­å±•ç¤º -->
  <div id="productCarousel" class="carousel slide product-carousel container mt-4" data-bs-ride="carousel">
    <div class="carousel-inner" id="carouselInner"></div>
    <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>

  <!-- å•†å“åˆ—è¡¨å±•ç¤º -->
  <div class="container mt-5">
    <div class="row" id="productList"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // =========================
    // ğŸ›’ è´­ç‰©è½¦æ•°é‡æ›´æ–°é€»è¾‘
    // =========================
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('cart') || '[]');
      const count = cart.reduce((acc, item) => acc + item.qty, 0);
      document.getElementById('cartCount').innerText = count;
    }

    // å‰å¾€è´­ç‰©è½¦é¡µ
    function goCart() {
      window.location.href = 'cart.html';
    }

    // åŠ å…¥è´­ç‰©è½¦
    function addToCart(id) {
      const cart = JSON.parse(localStorage.getItem('cart') || '[]');
      const existing = cart.find(item => item.id === id);
      if (existing) {
        existing.qty += 1;
      } else {
        cart.push({ id, qty: 1 });
      }
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartCount();
      showToast('å·²åŠ å…¥è´­ç‰©è½¦ âœ…');
    }

    // Toast æç¤º
    function showToast(msg) {
      const toast = document.createElement('div');
      toast.textContent = msg;
      toast.style.position = 'fixed';
      toast.style.bottom = '60px';
      toast.style.left = '50%';
      toast.style.transform = 'translateX(-50%)';
      toast.style.background = 'rgba(0,0,0,0.7)';
      toast.style.color = '#fff';
      toast.style.padding = '10px 20px';
      toast.style.borderRadius = '20px';
      toast.style.zIndex = '9999';
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 1500);
    }

    // =========================
    // ğŸ›ï¸ åŠ è½½å•†å“
    // =========================
    async function loadProducts() {
      try {
        const res = await axios.get("http://localhost:5001/api/products");
        const products = res.data;

        const carousel = document.getElementById("carouselInner");
        const productList = document.getElementById("productList");

        // åŠ è½½è½®æ’­
        carousel.innerHTML = products.slice(0, 5).map((p, i) => `
          <div class="carousel-item ${i === 0 ? 'active' : ''}">
            <img src="${p.image}" class="d-block w-100" alt="${p.name}" onclick="viewDetail(${p.id})">
            <div class="carousel-caption">
              <h5>${p.name}</h5>
              <p>${p.title || p.description || ''}</p>
            </div>
          </div>
        `).join('');

        // åŠ è½½å•†å“åˆ—è¡¨
        productList.innerHTML = products.map(p => `
          <div class="col-6 col-md-3 mb-4">
            <div class="card product-card">
              <img src="${p.image}" class="card-img-top" alt="${p.name}" style="height:180px;object-fit:cover;" onclick="viewDetail(${p.id})">
              <div class="card-body text-center">
                <h6>${p.name}</h6>
                <p class="text-danger mb-1">ï¿¥${p.price}</p>
                <button class="btn btn-sm btn-success" onclick="addToCart(${p.id})">åŠ å…¥è´­ç‰©è½¦</button>
              </div>
            </div>
          </div>
        `).join('');
      } catch (err) {
        console.error("å•†å“åŠ è½½å¤±è´¥", err);
        document.getElementById("productList").innerHTML = `<p class="text-center text-muted">å•†å“åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ã€‚</p>`;
      }
    }

    // æŸ¥çœ‹è¯¦æƒ…
    function viewDetail(id) {
      window.location.href = `detail.html?id=${id}`;
    }

    // åˆå§‹åŒ–
    loadProducts();
    updateCartCount();
  </script>
</body>
</html>
